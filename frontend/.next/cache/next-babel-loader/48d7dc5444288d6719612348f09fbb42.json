{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { ApolloClient } from \"apollo-client\";\nimport { InMemoryCache } from \"apollo-cache-inmemory\";\nimport { createHttpLink } from \"apollo-link-http\";\nimport { setContext } from \"apollo-link-context\";\nimport fetch from \"isomorphic-unfetch\";\nlet apolloClient = null;\nconst isBrowser = process.browser;\n\nif (!isBrowser) {\n  global.fetch = fetch;\n}\n\nfunction getToken() {\n  const token = sessionStorage.getItem(\"token\");\n\n  if (!token) {\n    return \"\";\n  }\n\n  return token;\n}\n\nconst defaultOptions = {\n  getToken\n};\n\nfunction create(initialState, {\n  getToken\n}) {\n  const httpLink = createHttpLink({\n    uri: \"http://localhost:4000\",\n    credentials: \"same-origin\"\n  });\n  const authLink = setContext((_, {\n    headers\n  }) => {\n    const token = getToken;\n    return {\n      headers: _objectSpread(_objectSpread({}, headers), {}, {\n        authorization: token\n      })\n    };\n  });\n  return new ApolloClient({\n    link: authLink.concat(httpLink),\n    cache: new InMemoryCache().restore(initialState || {})\n  });\n}\n\nexport default function initApollo(initialState, options = defaultOptions) {\n  if (!isBrowser) {\n    return create(initialState, options);\n  }\n\n  if (!apolloClient) {\n    apolloClient = create(initialState, options);\n  }\n\n  return apolloClient;\n}","map":{"version":3,"sources":["/Users/wyattqueirolo/Wyatt/mehappy/frontend/lib/graphql-client.ts"],"names":["ApolloClient","InMemoryCache","createHttpLink","setContext","fetch","apolloClient","isBrowser","process","browser","global","getToken","token","sessionStorage","getItem","defaultOptions","create","initialState","httpLink","uri","credentials","authLink","_","headers","authorization","link","concat","cache","restore","initApollo","options"],"mappings":";;;;;;AAAA,SAASA,YAAT,QAA6B,eAA7B;AACA,SAASC,aAAT,QAAqD,uBAArD;AACA,SAASC,cAAT,QAA+B,kBAA/B;AACA,SAASC,UAAT,QAA2B,qBAA3B;AACA,OAAOC,KAAP,MAAkB,oBAAlB;AAEA,IAAIC,YAAwD,GAAG,IAA/D;AAEA,MAAMC,SAAkB,GAAIC,OAAD,CAAiBC,OAA5C;;AAEA,IAAI,CAACF,SAAL,EAAgB;AACbG,EAAAA,MAAD,CAAgBL,KAAhB,GAAwBA,KAAxB;AACD;;AAMD,SAASM,QAAT,GAA4B;AAC1B,QAAMC,KAAK,GAAGC,cAAc,CAACC,OAAf,CAAuB,OAAvB,CAAd;;AACA,MAAI,CAACF,KAAL,EAAY;AACV,WAAO,EAAP;AACD;;AACD,SAAOA,KAAP;AACD;;AAED,MAAMG,cAAc,GAAG;AACrBJ,EAAAA;AADqB,CAAvB;;AAIA,SAASK,MAAT,CAAgBC,YAAhB,EAAmC;AAAEN,EAAAA;AAAF,CAAnC,EAA0D;AACxD,QAAMO,QAAQ,GAAGf,cAAc,CAAC;AAC9BgB,IAAAA,GAAG,EAAE,uBADyB;AAE9BC,IAAAA,WAAW,EAAE;AAFiB,GAAD,CAA/B;AAKA,QAAMC,QAAQ,GAAGjB,UAAU,CAAC,CAACkB,CAAD,EAAI;AAAEC,IAAAA;AAAF,GAAJ,KAAoB;AAC9C,UAAMX,KAAK,GAAGD,QAAd;AACA,WAAO;AACLY,MAAAA,OAAO,kCACFA,OADE;AAELC,QAAAA,aAAa,EAAEZ;AAFV;AADF,KAAP;AAMD,GAR0B,CAA3B;AAUA,SAAO,IAAIX,YAAJ,CAAiB;AACtBwB,IAAAA,IAAI,EAAEJ,QAAQ,CAACK,MAAT,CAAgBR,QAAhB,CADgB;AAEtBS,IAAAA,KAAK,EAAE,IAAIzB,aAAJ,GAAoB0B,OAApB,CAA4BX,YAAY,IAAI,EAA5C;AAFe,GAAjB,CAAP;AAID;;AAED,eAAe,SAASY,UAAT,CACbZ,YADa,EAEba,OAAO,GAAGf,cAFG,EAGwB;AACrC,MAAI,CAACR,SAAL,EAAgB;AACd,WAAOS,MAAM,CAACC,YAAD,EAAea,OAAf,CAAb;AACD;;AAED,MAAI,CAACxB,YAAL,EAAmB;AACjBA,IAAAA,YAAY,GAAGU,MAAM,CAACC,YAAD,EAAea,OAAf,CAArB;AACD;;AAED,SAAOxB,YAAP;AACD","sourcesContent":["import { ApolloClient } from \"apollo-client\";\nimport { InMemoryCache, NormalizedCacheObject } from \"apollo-cache-inmemory\";\nimport { createHttpLink } from \"apollo-link-http\";\nimport { setContext } from \"apollo-link-context\";\nimport fetch from \"isomorphic-unfetch\";\n\nlet apolloClient: ApolloClient<NormalizedCacheObject> | null = null;\n\nconst isBrowser: boolean = (process as any).browser;\n\nif (!isBrowser) {\n  (global as any).fetch = fetch;\n}\n\ninterface Options {\n  getToken: () => string;\n}\n\nfunction getToken(): string {\n  const token = sessionStorage.getItem(\"token\");\n  if (!token) {\n    return \"\";\n  }\n  return token;\n}\n\nconst defaultOptions = {\n  getToken,\n};\n\nfunction create(initialState: any, { getToken }: Options) {\n  const httpLink = createHttpLink({\n    uri: \"http://localhost:4000\",\n    credentials: \"same-origin\",\n  });\n\n  const authLink = setContext((_, { headers }) => {\n    const token = getToken;\n    return {\n      headers: {\n        ...headers,\n        authorization: token,\n      },\n    };\n  });\n\n  return new ApolloClient({\n    link: authLink.concat(httpLink),\n    cache: new InMemoryCache().restore(initialState || {}),\n  });\n}\n\nexport default function initApollo(\n  initialState: any,\n  options = defaultOptions\n): ApolloClient<NormalizedCacheObject> {\n  if (!isBrowser) {\n    return create(initialState, options);\n  }\n\n  if (!apolloClient) {\n    apolloClient = create(initialState, options);\n  }\n\n  return apolloClient;\n}\n"]},"metadata":{},"sourceType":"module"}